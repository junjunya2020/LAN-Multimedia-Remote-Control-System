<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŸ³æ¨‚æ’­æ”¾å™¨</title>
    <link rel="stylesheet" href="style.css">
</head>


<body>
    <h1>éŸ³æ¨‚æ’­æ”¾å™¨</h1>
 <!--    <div class="live-container">
        <div class="live-header">
            <h3>è©¦è©¦è§€çœ‹ç›´æ’­</h3>
            <button id="fullscreenBtn" class="fullscreen-btn" onclick="toggleFullscreen()" title="å…¨è¢å¹•è§€çœ‹">â›¶</button>
        </div>
        <div class="live-iframe-container">
            <iframe id="liveImg" src="http://10.233.0.75:8080" alt="ç›´æ’­" class="live-iframe"></iframe>
        </div>
    </div>
    -->
    <div class="content-wrapper">
        <!-- å·¦ä¾§æ’­æ”¾å™¨åŒºåŸŸ -->
        <div class="player-container">
                <!-- éŸ³é¢‘ä¿¡æ¯åŒºåŸŸ - ä¸“è¾‘å›¾ç‰‡åœ¨å·¦ä¾§ -->
                <div id="audio-info">
                    <!-- å°ˆè¼¯å°é¢ -->
                    <img
                        id="album-image"
                        src=""
                        alt="å°ˆè¼¯å°é¢"
                    >
                    <!-- éŸ³é »å…ƒæ•¸æ“šé¡¯ç¤ºå€åŸŸ -->
                    <div id="metadata-display">
                        <h2 id="track-title">æœªé¸æ“‡æ›²ç›®</h2>
                        <p id="track-artist"></p>
                        <p id="track-album"></p>
                        <p id="track-bitrate"></p>
                        <p id="track-file-path"></p>
                    </div>
                </div>

                <!-- è¿›åº¦æ¡ -->
                <div class="progress-container">
                    <div class="progress-bar" onclick="seekToPosition(event)">
                        <div class="progress-fill" id="progress-fill" style="width: 0%;"></div>
                    </div>
                    <div class="time-display">
                        <span id="current-time">00:00</span>
                        <span id="total-time">00:00</span>
                    </div>
                </div>

                <!-- æ’­æ”¾æ§åˆ¶æŒ‰éˆ• -->
                <div id="controls">
                    <button id="prevButton" onclick="prevTrack()">â®ï¸</button>
                    <button id="playPauseButton" onclick="togglePlayPause()">â–¶ï¸</button>
                    <button onclick="stop()">â¹ï¸</button>
                    <button id="nextButton" onclick="nextTrack()">â­ï¸</button>
                    <button id="playModeButton" onclick="togglePlayMode()" title="æ’­æ”¾æ¨¡å¼">ğŸ”</button>
                    <button id="fileManagerBtn" onclick="openFileManager()" title="é–‹å•Ÿæª”æ¡ˆç®¡ç†å“¡">ğŸ“</button>
                    <button id="searchLyricsBtn" onclick="searchLyrics()" title="æœå°‹æ­Œè©">ğŸ”</button>
                    <button id="historyBtn" onclick="openPlaybackHistory()" title="æŸ¥çœ‹æ’­æ”¾æ­·å²">ğŸ“œ</button>
                    <button id="restartButton" onclick="restartPlayer()" title="é‡æ–°å•Ÿå‹•æ’­æ”¾å™¨">ğŸ”„</button>
                </div>
                
                <!-- æ’­æ”¾ä¾†æºè¨­å®š -->
                <div class="play-source-container">
                    <div class="play-source-label">
                        <span>ğŸµ æ’­æ”¾ä¾†æº</span>
                    </div>
                    <div class="play-source-controls">
                        <label>
                            <input type="radio" name="play_source" value="1" id="play_source_playlist" onchange="updatePlaySource(1)">
                            <span>æ’­æ”¾æ¸…å–®</span>
                        </label>
                        <label>
                            <input type="radio" name="play_source" value="2" id="play_source_directory" onchange="updatePlaySource(2)">
                            <span>ç£ç¢Ÿè·¯å¾‘</span>
                        </label>
                    </div>
                    <div class="play-source-hint" id="play-source-hint">
                        <small>åˆ‡æ›æ’­æ”¾ä¾†æºå°‡å½±éŸ¿ä¸‹ä¸€æ›²ç­‰æ“ä½œçš„æ’­æ”¾æº</small>
                    </div>
                </div>
                
                <!-- éŸ³è»Œé¸æ“‡ -->
                <div class="audio-track-container">
                    <div class="audio-track-label">
                        <span>ğŸ›ï¸ éŸ³è»Œé¸æ“‡</span>
                    </div>
                    <div class="audio-track-controls">
                        <select id="audioTrackSelect" onchange="changeAudioTrack()" title="é¸æ“‡éŸ³è»Œ">
                            <option value="0">æ­£å¸¸æ’­æ”¾</option>
                            <option value="1">äººè²</option>
                            <option value="2">ä¼´å¥</option>
                        </select>
                        <button id="aiSeparateBtn" onclick="aiSeparateAudio()" title="ä½¿ç”¨AIåˆ†é›¢éŸ³é »" style="margin-left: 10px;">ğŸ¤– AIåˆ†é›¢</button>
                    </div>
                    <div class="audio-track-hint" id="audio-track-hint">
                        <small>å¯åˆ‡æ›éŸ³æ¨‚çš„äººè²ã€ä¼´å¥ç­‰ä¸åŒéŸ³è»Œ</small>
                    </div>
                </div>
                
                <!-- éŸ³é‡æ§åˆ¶æ¢ -->
                <div class="volume-container">
                    <div class="volume-label">
                        <span>ğŸ”Š éŸ³é‡</span>
                        <span id="volume-value">50%</span>
                    </div>
                    <div class="volume-bar" onclick="setVolumeFromClick(event)">
                        <div class="volume-fill" id="volume-fill" style="width: 50%;"></div>
                    </div>
                </div>
                
                <!-- æ­Œè©é¡¯ç¤ºå€åŸŸ -->
                <div id="lyrics-container">
                    <div class="lyrics-header">
                        <h3>ç•¶å‰æ­Œè©</h3>
                        <div class="lyrics-actions">
                            <button id="view-full-lyrics" onclick="viewFullLyrics()">æŸ¥çœ‹å…¨éƒ¨æ­Œè©</button>
                            <button id="toggle-traditional" class="toggle-traditional" onclick="toggleTraditionalChinese()" title="ç°¡ç¹è½‰æ›">ç¹</button>
                        </div>
                    </div>
                    <div id="current-lyrics" class="lyrics-display">æš«ç„¡æ­Œè©</div>
                </div>

                <!-- æ’­æ”¾æ¸…å–®å€åŸŸ -->
                <div id="playlist-container">
                    <div class="playlist-header">
                        <h3>æ’­æ”¾æ¸…å–®</h3>
                        <div class="playlist-actions">
                            <button onclick="addDouyinAudio()" title="æ–°å¢æŠ–éŸ³éŸ³é »">ğŸ“±</button>
                            <button onclick="addBilibiliVideo()" title="æ–°å¢Bilibiliè¦–é »">ğŸ“º</button>
                            <button onclick="refreshPlaylist()" title="é‡æ–°æ•´ç†æ’­æ”¾æ¸…å–®">ğŸ”„</button>
                            <button onclick="clearPlaylist()" title="æ¸…ç©ºæ’­æ”¾æ¸…å–®">ğŸ—‘ï¸</button>
                        </div>
                    </div>
                    <div id="playlist-items" class="playlist-items">
                        <div class="empty-playlist">æ’­æ”¾æ¸…å–®ç‚ºç©ºï¼Œè«‹æ–°å¢éŸ³æ¨‚æª”æ¡ˆ</div>
                    </div>
                </div>
            </div>
        </div>
    </div>




    <!-- æ–°å¢ï¼šå•Ÿç”¨ Socket.IO å‹¾é¸æ¡† -->
    <div style="position: fixed; bottom: 20px; right: 20px; background: #333; padding: 10px; border-radius: 5px; color: white;">
        <label for="enableSocket">å•Ÿç”¨ Socket.IO å³æ™‚åŒæ­¥</label>
        <input type="checkbox" id="enableSocket">
    </div>

    <script src="../socket.io.min.js"></script> <!-- Socket.IO CDN -->
    <script src="./console.js"></script>
    <script src="./tools.js"></script>
    <script src="./syncBroadcast.js"></script>
    <script src="./player.js"></script>
    <script src="./socketio.js"></script>
    <script src="./progress.js"></script>
    <script src="./Volume.js"></script>
    <script src="./Playlist.js"></script>
    <script src="./PlaySource.js"></script>
    <script src="./AudioTrack.js"></script>
    <script src="./opencc.js"></script> <!-- OpenCC ç®€ç¹è½¬æ¢åº“ -->
    <script src="./script.js"></script>

    <script>
        // å…¨å±åŠŸèƒ½
        function toggleFullscreen() {
            const iframe = document.getElementById('liveImg');
            const container = document.querySelector('.live-container');
            
            if (!document.fullscreenElement) {
                // è¿›å…¥å…¨å±
                if (container.requestFullscreen) {
                    container.requestFullscreen();
                } else if (container.webkitRequestFullscreen) {
                    container.webkitRequestFullscreen();
                } else if (container.msRequestFullscreen) {
                    container.msRequestFullscreen();
                }
            } else {
                // é€€å‡ºå…¨å±
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
            }
        }

        // ç›‘å¬å…¨å±çŠ¶æ€å˜åŒ–
        document.addEventListener('fullscreenchange', handleFullscreenChange);
        document.addEventListener('webkitfullscreenchange', handleFullscreenChange);
        document.addEventListener('msfullscreenchange', handleFullscreenChange);

        function handleFullscreenChange() {
            const fullscreenBtn = document.getElementById('fullscreenBtn');
            if (document.fullscreenElement) {
                fullscreenBtn.textContent = 'â›¶';
                fullscreenBtn.title = 'é€€å‡ºå…¨è¢å¹•';
            } else {
                fullscreenBtn.textContent = 'â›¶';
                fullscreenBtn.title = 'å…¨è¢å¹•è§€çœ‹';
            }
        }
    </script>

</body>

</html>